<!DOCTYPE html>
<html>
<body>

<canvas id="simulator" style="border:1px solid #d3d3d3;">
Your browser does not support the HTML5 canvas tag.</canvas>
<br>
<span>Current X: </span><span id="x"></span><br>
<span>Current Y: </span><span id="y"></span><br>
<span>Current V(X): </span><span id="v_x"></span><br>
<span>Current V(Y): </span><span id="v_y"></span><br>
<span>Current A(X): </span><span id="a_x"></span><br>
<span>Current A(Y): </span><span id="a_y"></span><br>
<span>Current RSSI: </span><span id="rssi"></span><br>
<span id="debug"></span><br>

<script>

var canvas = document.getElementById("simulator");
canvas.width = 800;
canvas.height = 600;
var ctx = canvas.getContext("2d");
var frame_rate = 60;

var rssi_radius = 300;
var cur_x = 10;
var cur_y = 100;
var speed_x = 1;
var speed_y = 3;
var acc_x = 1;
var acc_y = 1;

function init_rssi() {
   var grd = ctx.createRadialGradient(canvas.width/2, canvas.height/2, rssi_radius, canvas.width/2, canvas.height/2, 0);
   grd.addColorStop(1, "red");
   grd.addColorStop(0, "white");

   ctx.fillStyle = grd;
   ctx.beginPath();
   ctx.arc(canvas.width/2, canvas.height/2, rssi_radius, 0, 2 * Math.PI);
   ctx.fill();
   ctx.closePath();
}

function update_drone() {
   ctx.clearRect(0, 0, canvas.width, canvas.width);
   
   init_rssi();

   var p = ctx.getImageData(cur_x, cur_y, 10, 10).data;
   var rssi = p[1] == 0 ? 0 : 255-p[1];

   ctx.fillStyle = "rgb(150,28,28)";
   ctx.beginPath();
   ctx.arc(cur_x, cur_y, 5, 0, 2 * Math.PI);
   ctx.fill();
   ctx.closePath(); 

   // v = v + at
   speed_x += acc_x/frame_rate;
   speed_y += acc_y/frame_rate;

   // boundary
   if (cur_x >= canvas.width | cur_x <= 0) {
      speed_x *= -1;
   }
   if (cur_y >= canvas.height | cur_y <= 0) {
      speed_y *= -1;
   }

   cur_x += speed_x;
   cur_y += speed_y;

   document.getElementById("x").innerHTML = cur_x;
   document.getElementById("y").innerHTML = cur_y;
   document.getElementById("v_x").innerHTML = speed_x;
   document.getElementById("v_y").innerHTML = speed_y;
   document.getElementById("a_x").innerHTML = acc_x;
   document.getElementById("a_y").innerHTML = acc_y;
   document.getElementById("rssi").innerHTML = rssi;
}

setInterval(update_drone, 1000/frame_rate);

</script> 

</body>
</html>

